<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Mise en pratique de Node.js Auteur(s) : Erwan ROUSSEL
Prérequis: Apprendre à utiliser NodeJS
Introduction Dans ce mini-tutoriel vous allez réaliser une petite API avec Node.Js et les librairies ExpressJs. À partir d&rsquo;un fichier JSON répertoriant des fleurs, nous allons retourner la liste et les détails de celles-ci.
Nous allons utiliser un fichier JSON pour simuler une base de donnée mais il est plus fréquent d&rsquo;utiliser une base de donnée surtout dès lors qu&rsquo;il y a des données sensibles à stocker (comme des mots de passe ou des informations sur l&rsquo;utilisateur)."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Mise en pratique de Node.js"><meta property="og:description" content="Mise en pratique de Node.js Auteur(s) : Erwan ROUSSEL
Prérequis: Apprendre à utiliser NodeJS
Introduction Dans ce mini-tutoriel vous allez réaliser une petite API avec Node.Js et les librairies ExpressJs. À partir d&rsquo;un fichier JSON répertoriant des fleurs, nous allons retourner la liste et les détails de celles-ci.
Nous allons utiliser un fichier JSON pour simuler une base de donnée mais il est plus fréquent d&rsquo;utiliser une base de donnée surtout dès lors qu&rsquo;il y a des données sensibles à stocker (comme des mots de passe ou des informations sur l&rsquo;utilisateur)."><meta property="og:type" content="article"><meta property="og:url" content="https://wiki.openincubator.tech/docs/javascript/practice_nodejs/"><title>Mise en pratique de Node.js | Open Ressources</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.6df681b0bb21155cba49f6078e3559216772d8e03e780d240c73ea21817ed5e5.css integrity="sha256-bfaBsLshFVy6SfYHjjVZIWdy2OA+eA0kDHPqIYF+1eU="><script defer src=/en.search.min.12e6b400db9dbfc7a15582d15fc967f81b6a5c6bc8ac13e0798c3511d68d12ff.js integrity="sha256-Eua0ANudv8ehVYLRX8ln+BtqXGvIrBPgeYw1EdaNEv8="></script></head><body><input type=checkbox class=hidden id=menu-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>Open Ressources</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><strong><a href>Git</a></strong><ul><li><a href=/docs/git/learn_git/>Apprendre à utiliser Git</a></li><li><a href=/docs/git/learn_github/>Apprendre à utiliser Github</a></li></ul></li><li><strong><a href>Javascript</a></strong><ul><li><a href=https://developer.mozilla.org/fr/docs/Web/JavaScript/Guide>Apprendre le JavaScript</a></li><li><a href=/docs/javascript/learn_nodejs/>Apprendre à utiliser NodeJS</a></li><li><a href=/docs/javascript/practice_nodejs/ class=active>Mise en pratique de NodeJS</a></li><li><a href=/docs/javascript/learn_typescript/>Apprendre le Typescript</a></li></ul></li><li><strong><a href>Serveur</a></strong><ul><li><a href=/docs/serveur/introduction/>Introduction</a></li><li><a href=https://lecrabeinfo.net/installer-linux-debian-le-guide-complet.html>Installer Debian</a></li><li><a href=/docs/serveur/webserver_install/>Installer un serveur web</a></li><li><a href=/docs/serveur/webserver_configure_php/>Configurer un serveur web pour PHP</a></li><li><a href=/docs/serveur/webserver_configure_serverless/>Configurer un serveur web pour NodeJS</a></li><li><a href=/docs/serveur/webserver_secure>Sécuriser un serveur</a></li><li><a href=docs/serveur/learn_docker.md>Apprendre à utiliser Docker</a></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Mise en pratique de Node.js</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><input type=checkbox class=hidden id=toc-control><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#installation-des-dépendances>Installation des dépendances</a></li><li><a href=#création-de-lapplication-express>Création de l&rsquo;application express</a></li><li><a href=#création-de-lapi>Création de l&rsquo;API</a><ul><li><a href=#liste-des-fleurs>Liste des fleurs</a></li><li><a href=#afficher-le-détail-dune-fleur>Afficher le détail d&rsquo;une fleur</a></li></ul></li><li><a href=#pour-approfondir>Pour approfondir</a></li></ul></nav></aside></header><article class=markdown><h1 id=mise-en-pratique-de-nodejs>Mise en pratique de Node.js</h1><p><em>Auteur(s) : Erwan ROUSSEL</em></p><p><em>Prérequis: <a href=/docs/javascript/learn_nodejs/>Apprendre à utiliser NodeJS</a></em></p><h2 id=introduction>Introduction</h2><p>Dans ce mini-tutoriel vous allez réaliser une petite API avec Node.Js et les librairies ExpressJs. À partir d&rsquo;un fichier JSON répertoriant des fleurs, nous allons retourner la liste et les détails de celles-ci.</p><p><em>Nous allons utiliser un fichier JSON pour simuler une base de donnée mais il est plus fréquent d&rsquo;utiliser une base de donnée surtout dès lors qu&rsquo;il y a des données sensibles à stocker (comme des mots de passe ou des informations sur l&rsquo;utilisateur).</em></p><h2 id=installation-des-dépendances>Installation des dépendances</h2><p>Nous allons tout d&rsquo;abbord initialiser le projet :</p><ul><li>Créer un dossier, puis s&rsquo;y rendre avec un terminal</li><li>Utilisez la commande <code>npm init</code> et validez les champs par défaut</li></ul><p>Un fichier <code>package.json</code> est alors créé à la racine du projet.</p><p>Nous allons installer ExpressJs un <em>framework web minimalist</em> (un outil pour vous aider à créer des applications web plus rapidement). ExpressJs n&rsquo;est pas le seul framework disponible pour NodeJS, voici une liste non-exhaustive de ceux-ci (liste plus complète <a href=https://nodejs.dev/learn#nodejs-frameworks-and-tools>ici</a> <em>le contenu du lien est en anglais</em>):</p><ul><li><a href=https://adonisjs.com/><strong>AdonisJs</strong></a>: Un framework complet hautement orienté sur la stabilité et l&rsquo;ergonomie du développeur. Adonis est l&rsquo;un des frameworks Node.js les plus rapide.</li><li><a href=https://fastify.io/><strong>Fastify</strong></a>: Un frameworks web qui a pour but de donner au développeur la meilleure expérience possible avec moins de prise de tête et un puissant système de plugin. Il est aussi l&rsquo;un des plus rapide.</li><li><a href=https://hapijs.com><strong>hapi</strong></a>: Un framework riche pour construire des applications et des services qui permette au développeur de se concentrer sur l'écriture d&rsquo;une logique réutilisable au lieu de perdre du temps à construire l&rsquo;infrastructure.</li><li><a href=https://socket.io/><strong>Socket.io</strong></a>: Un moteur de communication en temps réel pour construire des applications réseaux.</li></ul><p>Comme vu dans le guide précédent, il suffit de lancer cette commande afin d&rsquo;installer ExpressJs :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>npm install express --save
</code></pre></div><p><em>Le drapeau <code>--save</code> indique à npm d&rsquo;ajouter express à la liste de dépendances du fichier package.json, ainsi si vous reprenez le projet sur un autre ordinateur vous n&rsquo;aurez qu'à faire <code>npm install</code> afin d&rsquo;installer toutes les dépendances listées dans le <code>package.json</code></em>.</p><p>Nous allons aussi télécharger le fichier JSON répertoriant les fleurs <a href=https://gist.github.com/sandeepcmsm/2e1f5762fa5ca351d8f129e73c730071>ici</a>.</p><h2 id=création-de-lapplication-express>Création de l&rsquo;application express</h2><p>Nous allons maintenant commencer à coder.</p><ul><li>Créez un fichier .js (nous allons créer <code>index.js</code> mais vous pouvez très bien l&rsquo;appeler app.js ou bien server.js ou bien comme vous souhaitez le nommer).</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// On importe la librairie express précédament installée
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>express</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;express&#39;</span>)

<span style=color:#75715e>// On initialise notre application express
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>app</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>express</span>()

<span style=color:#75715e>// On définit le port sur lequel notre application va se lancer
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>port</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3000</span>

<span style=color:#75715e>// On crée notre première route (plus de détails sur cette partie juste en dessous)
</span><span style=color:#75715e></span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>) =&gt; <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#39;Hello World!&#39;</span>))

<span style=color:#75715e>// On lance le serveur avec le port défini
</span><span style=color:#75715e></span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>listen</span>(<span style=color:#a6e22e>port</span>, () =&gt; <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`Le serveur écoute sur le port </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>port</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>))
</code></pre></div><p>La méthode get prend deux paramètres, le chemin de la route (ici <code>/</code>, c&rsquo;est à dire <code>http://localhost:3000/</code>&rsquo;) et la fonction a appeler avec les données de la requête (ici elle renvoie juste <code>Hello World!</code>).</p><p>Si vous vous rendez sur votre navigateur à l&rsquo;addresse <a href=http://localhost:3000/>http://localhost:3000/</a> vous devriez apercevoir <code>Hello World!</code>.</p><h2 id=création-de-lapi>Création de l&rsquo;API</h2><p>Nous allons avoir seulement deux routes pour cette API (nous ne ferons pas de modifications donc nous ne traiterons pas de requête POST ou PUT)</p><ul><li><code>GET /flowers</code> : liste toutes les fleurs</li><li><code>GET /flowers/:id</code> : affiche les détails d&rsquo;une fleur</li></ul><h3 id=liste-des-fleurs>Liste des fleurs</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// On importe le module fs au début du fichier
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>fs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;fs&#39;</span>)

<span style=color:#75715e>// ...
</span><span style=color:#75715e></span>
<span style=color:#75715e>// On déclare la route
</span><span style=color:#75715e></span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/flowers&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>, <span style=color:#a6e22e>next</span>) =&gt; {

	<span style=color:#75715e>// On lit le fichier 
</span><span style=color:#75715e></span>	<span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>readFile</span>(<span style=color:#e6db74>&#39;flowers.json&#39;</span>, (<span style=color:#a6e22e>err</span>, <span style=color:#a6e22e>data</span>) =&gt; {
		<span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>err</span>) {
			<span style=color:#a6e22e>next</span>(<span style=color:#a6e22e>err</span>)
		} <span style=color:#66d9ef>else</span> {
			<span style=color:#75715e>// On envoie le contenu du fichier en précisant qu&#39;il s&#39;agit de JSON
</span><span style=color:#75715e></span>			<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>json</span>(<span style=color:#a6e22e>data</span>)	
		}
	})
})
</code></pre></div><p>On remarque qu&rsquo;on a un paramètre en plus à notre callback, le paramètre <code>next</code> il permet ici à express de gérer les erreurs à notre place.</p><p><code>res.json(data)</code> quant à lui modifie le Header appelé <code>Content-Type</code> pour préciser qu&rsquo;il s&rsquo;agit de JSON puis envoie la réponse avec le contenu du fichier.</p><p>Vous pouvez maintenant vous rendre à cette addresse <a href=http://localhost:3000/flowers>http://localhost:3000/flowers</a> vous devriez voir la liste des fleurs</p><h3 id=afficher-le-détail-dune-fleur>Afficher le détail d&rsquo;une fleur</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/flower/:id&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>, <span style=color:#a6e22e>next</span>) =&gt; {
	<span style=color:#75715e>// On récupère le paramètre de l&#39;URL
</span><span style=color:#75715e></span>	<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>id</span>

	<span style=color:#75715e>// On lit le fichier
</span><span style=color:#75715e></span>	<span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>readFile</span>(<span style=color:#e6db74>&#39;flowers.json&#39;</span>, (<span style=color:#a6e22e>err</span>, <span style=color:#a6e22e>data</span>) =&gt; {
    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>err</span>) {                
      <span style=color:#a6e22e>next</span>(<span style=color:#a6e22e>err</span>)              
    } <span style=color:#66d9ef>else</span> {                
 	    <span style=color:#75715e>// On récupère l&#39;objet de la fleur dans le json 
</span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>flower</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>data</span>[<span style=color:#a6e22e>id</span>])

			<span style=color:#75715e>// On renvoit l&#39;objet sous format json
</span><span style=color:#75715e></span>      <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>json</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>flower</span>))
    }                           
  })	
})
</code></pre></div><p>On a ici appris à récupèrer les paramètres d&rsquo;une URL à l&rsquo;aide de la propriété <code>req.params</code>.</p><h2 id=pour-approfondir>Pour approfondir</h2><p>Après cette petite découverte je vous invite à aller regarder <a href=https://expressjs.com/>la documentation d&rsquo;ExpressJS</a> <em>le contenu de ce lien est en anglais</em> ainsi que celle des autres frameworks que j&rsquo;ai mis au dessus.</p><p>Vous pouvez aussi jeter un coup d&rsquo;oeil à <a href=https://www.frugalprototype.com/developpez-propre-api-node-js-express/>ce guide</a> qui est plus complet puisqu&rsquo;il aborde aussi la récupération des données envoyées par la méthode POST.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/open-incubator/wiki/edit/master/content//docs/Javascript/practice_nodejs.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#installation-des-dépendances>Installation des dépendances</a></li><li><a href=#création-de-lapplication-express>Création de l&rsquo;application express</a></li><li><a href=#création-de-lapi>Création de l&rsquo;API</a><ul><li><a href=#liste-des-fleurs>Liste des fleurs</a></li><li><a href=#afficher-le-détail-dune-fleur>Afficher le détail d&rsquo;une fleur</a></li></ul></li><li><a href=#pour-approfondir>Pour approfondir</a></li></ul></nav></aside></main></body></html>